# Excel 导入指南

本文档详细说明如何准备 Excel 文件以导入学生信息和成绩数据。

---

## 目录

1. [学生信息导入](#1-学生信息导入)
2. [成绩导入](#2-成绩导入)
3. [常见问题](#3-常见问题)

---

## 1. 学生信息导入

### 1.1 必填字段

导入学生信息时，以下 4 个字段为必填：

| 字段名 | 说明 | 示例 |
|-------|-----|------|
| 学号 | 班内唯一标识 | 2024001 |
| 姓名 | 学生姓名 | 张三 |
| 家长1姓名 | 第一监护人姓名 | 张父 |
| 家长1电话 | 第一监护人电话 | 13800138000 |

### 1.2 完整字段列表

除必填字段外，还支持以下 24 个可选字段：

| 字段名 | 数据类型 | 说明 | 示例 |
|-------|---------|-----|------|
| 性别 | 文本 | 男/女 | 男 |
| 出生日期 | 日期 | YYYY-MM-DD 格式 | 2010-05-15 |
| 身高 | 数字 | 单位：cm | 145 |
| 视力 | 文本 | 如 5.0 | 5.0 |
| 毕业小学 | 文本 | 毕业的小学名称 | XX小学 |
| 家庭住址 | 文本 | 家庭住址 | XX路XX号 |
| 联系方式 | 文本 | 学生电话 | 13900139000 |
| 交通方式 | 文本 | 上学交通方式 | 公交 |
| 车牌号 | 文本 | 校车/私家车牌号 | 京A12345 |
| 家长1称谓 | 文本 | 如 父亲、母亲 | 父亲 |
| 家长1工作单位 | 文本 | 工作单位 | XX公司 |
| 家长1职务 | 文本 | 职务 | 经理 |
| 家长2姓名 | 文本 | 第二监护人姓名 | 李母 |
| 家长2电话 | 文本 | 第二监护人电话 | 13900139001 |
| 家长2称谓 | 文本 | 如 父亲、母亲 | 母亲 |
| 家长2工作单位 | 文本 | 工作单位 | XX单位 |
| 家长2职务 | 文本 | 职务 | 主任 |
| 就读小学 | 文本 | 就读的小学 | XX小学 |
| 担任职务 | 文本 | 班干部等职务 | 班长 |
| 获奖情况 | 文本 | 获奖记录 | 三好学生 |
| 其他特长 | 文本 | 特长爱好 | 书法 |
| 身份证号 | 文本 | 18位身份证号 | 110101201005151234 |

### 1.3 Excel 模板

创建一个 Excel 文件，第一行为表头，包含所需字段：

```
学号    姓名    性别    出生日期    身高    视力    家长1姓名    家长1电话
2024001 张三    男      2010-05-15  145     5.0     张父        13800138000
2024002 李四    女      2010-06-20  142     5.1     李母        13900139000
2024003 王五    男      2010-03-10  148     4.9     王父        13700137000
```

### 1.4 导入步骤

1. 在应用中进入 **班级管理** → **班级详情**
2. 点击 **导入学生** 按钮
3. 选择准备好的 Excel 文件
4. 系统自动解析并导入数据

### 1.5 注意事项

- **学号必须唯一**：同一班级内学号不能重复
- **必填字段不能为空**：学号、姓名、家长1姓名、家长1电话必须填写
- **日期格式**：出生日期使用 `YYYY-MM-DD` 格式，如 `2010-05-15`
- **部分导入**：可以只填写部分字段，未填写的字段将保持为空
- **更新数据**：如果学号已存在，导入会更新该学生的信息

---

## 2. 成绩导入

### 2.1 文件结构

成绩 Excel 文件需要包含多个 Sheet（工作表），每个科目一个 Sheet：

| Sheet 名称（简称） | Sheet 名称（全称） | 科目 |
|------------------|-----------------|------|
| 总 | 总分 | 总成绩 |
| 语 | 语文 | 语文 |
| 数 | 数学 | 数学 |
| 英 | 英语 | 英语 |
| 科 | 科学 | 科学 |
| 社 | 社会 | 道德与法治 |

**说明**：应用同时支持简称和全称，任选一种即可。

### 2.2 表头格式

每个 Sheet 的第一行为表头，格式如下：

```
学号    姓名    总分    名次    系数
2024001 张三    280     1       1.0
2024002 李四    265     5       1.0
2024003 王五    275     2       1.0
```

**字段说明**：

| 字段名 | 必填 | 说明 | 示例 |
|-------|-----|------|-----|
| 学号 | ✅ | 学生学号，与学生信息匹配 | 2024001 |
| 姓名 | ✅ | 学生姓名 | 张三 |
| 总分 | ✅ | 该科目成绩 | 90 |
| 名次 | ❌ | 该科目排名 | 5 |
| 系数 | ❌ | 加分系数，默认1.0 | 1.0 |

### 2.3 完整示例

一个完整的成绩 Excel 文件结构如下：

#### Sheet 1: 总（总分）
```
学号    姓名    总分    名次    系数
2024001 张三    560     1       1.0
2024002 李四    520     8       1.0
2024003 王五    545     3       1.0
```

#### Sheet 2: 语（语文）
```
学号    姓名    总分    名次    系数
2024001 张三    95      2       1.0
2024002 李四    88      10      1.0
2024003 王五    92      5       1.0
```

#### Sheet 3: 数（数学）
```
学号    姓名    总分    名次    系数
2024001 张三    98      1       1.0
2024002 李四    85      12      1.0
2024003 王五    96      2       1.0
```

#### Sheet 4-6: 英、科、社（英语、科学、社会）
（格式同上）

### 2.4 评分标准

应用内置以下评分标准：

| 科目 | 满分 | 及格线 (60%) | 优秀线 (90%) |
|-----|-----|------------|-------------|
| 语文 | 120 | 72 | 108 |
| 数学 | 120 | 72 | 108 |
| 英语 | 120 | 72 | 108 |
| 科学 | 120 | 72 | 108 |
| 道德 | 100 | 60 | 90 |

### 2.5 导入步骤

1. 在应用中进入 **成绩管理** → **考试列表**
2. 点击 **添加考试** 或选择已有考试
3. 点击 **导入成绩** 按钮
4. 选择准备好的 Excel 文件
5. 系统自动解析各 Sheet 并导入成绩

### 2.6 注意事项

- **学号匹配**：成绩表中的学号必须与学生信息中的学号一致
- **Sheet 名称**：必须使用指定的 Sheet 名称（总/语/数/英/科/社 或 全称）
- **表头一致**：每个 Sheet 的第一行必须是表头（学号、姓名、总分、名次、系数）
- **部分科目**：可以只导入部分科目的成绩
- **更新数据**：如果学生已有该考试的成绩，导入会更新成绩数据

---

## 3. 常见问题

### Q1: 导入时提示"学号不存在"？

**原因**：成绩表中的学号在学生信息中不存在。

**解决**：
- 先导入学生信息
- 确保成绩表中的学号与学生信息中的学号完全一致
- 检查是否有空格或其他隐藏字符

### Q2: 导入时提示"表头格式错误"？

**原因**：Excel 表头格式不正确。

**解决**：
- 确保第一行是表头
- 表头字段名必须完全匹配（学号、姓名、总分、名次、系数）
- 检查是否有中英文混用

### Q3: 部分学生导入失败？

**原因**：必填字段为空或数据格式错误。

**解决**：
- 检查必填字段是否都有值
- 检查日期格式是否为 `YYYY-MM-DD`
- 检查数字字段是否包含非数字字符

### Q4: 可以只导入部分字段吗？

**答**：可以。除必填字段外，其他字段可以留空，应用只会导入有值的字段。

### Q5: 可以更新已存在的数据吗？

**答**：可以。如果学号已存在，导入会更新该学生的信息；如果该考试的成绩已存在，导入会更新成绩数据。

### Q6: Excel 文件有格式要求吗？

**答**：支持 `.xlsx` 和 `.xls` 格式的 Excel 文件。建议使用 `.xlsx` 格式以获得最佳兼容性。

### Q7: 成绩导入时需要所有科目都存在吗？

**答**：不需要。可以只导入部分科目的成绩，应用会根据实际存在的 Sheet 导入对应科目的成绩。

---

## 4. 模板下载

如果你需要模板，可以按照以下格式自行创建：

### 学生信息模板 (students.xlsx)

```
学号    姓名    性别    出生日期    家长1姓名    家长1电话
2024001 张三    男      2010-05-15  张父        13800138000
```

### 成绩模板 (scores.xlsx)

创建一个包含 6 个 Sheet 的 Excel 文件：
- Sheet 1 命名为"总"
- Sheet 2 命名为"语"
- Sheet 3 命名为"数"
- Sheet 4 命名为"英"
- Sheet 5 命名为"科"
- Sheet 6 命名为"社"

每个 Sheet 的第一行：
```
学号    姓名    总分    名次    系数
```

---

## 5. 联系支持

如果遇到其他问题，请：
1. 检查 Excel 文件格式是否符合要求
2. 查看应用内的错误提示
3. 在 GitHub 仓库提交 Issue：https://github.com/yunkst/zhaos-tools/issues
